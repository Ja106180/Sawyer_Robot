<?xml version="1.0"?>
<launch>
  <!-- YOLO 检测参数 -->
  <arg name="model_path" default="/home/mycar/YOLO/ultralytics-8.3.163/yolov8n_landmark.pt" />
  <arg name="yolo_source" default="1" />          <!-- 1 表示头部摄像头 -->
  <arg name="yolo_stream" default="true" />
  <arg name="yolo_window_name" default="YOLO Inference" />
  <arg name="yolo_conf_threshold" default="0.5" />  <!-- YOLO 自身的检测置信度阈值 -->

  <!-- 抓取参数（C++ 节点使用） -->
  <arg name="calibration_path" default="$(find Position_Calibration)/config/calibration.yaml" />
  <arg name="table_height" default="0.746" />
  <arg name="object_height" default="0.085" />
  <arg name="conf_threshold" default="0.7" />    <!-- 抓取触发置信度阈值 -->
  <arg name="stable_time" default="5.0" />
  <arg name="position_threshold" default="10.0" />
  <arg name="min_detections" default="5" />

  <!-- 启动抓取节点 (C++版本)
       初始化时会自动按顺序执行：
         j1_set → j2_set → j3_set → j4_set → j5_set → j6_set → gnd_set(j0) → head_set -->
  <node name="visual_grasping" pkg="visual_grasping" type="visual" output="screen">
    <param name="calibration_path" value="$(arg calibration_path)" />
    <param name="table_height" value="$(arg table_height)" />
    <param name="object_height" value="$(arg object_height)" />
    <param name="conf_threshold" value="$(arg conf_threshold)" />
    <param name="stable_time" value="$(arg stable_time)" />
    <param name="position_threshold" value="$(arg position_threshold)" />
    <param name="min_detections" value="$(arg min_detections)" />
  </node>

  <!-- 启动 YOLO 检测节点（等同于 rosrun yolo_package yolo_landmark.py） -->
  <node name="yolo_detection" pkg="yolo_package" type="yolo_landmark.py" output="screen">
    <param name="model" value="$(arg model_path)" />
    <param name="source" value="$(arg yolo_source)" />
    <param name="stream" value="$(arg yolo_stream)" />
    <param name="window_name" value="$(arg yolo_window_name)" />
    <param name="conf_threshold" value="$(arg yolo_conf_threshold)" />
    <!-- 为了让 YOLO 在机械臂初始化完成后再开始工作，这里增加一个启动延时（秒） -->
    <param name="startup_delay" value="8.0" />
  </node>

  <!-- 启动头部图片显示 -->
  <node name="head_display_image" pkg="intera_examples" type="head_display_image.py" args="-f /home/mycar/Image/face.png" output="screen" />
</launch>

